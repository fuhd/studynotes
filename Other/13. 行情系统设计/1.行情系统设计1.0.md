行情系统设计1.0版
=======================================================================
### 数据结构（用于app端显示用）
+ 原始行情数据结构
+ 动态行情数据结构
+ 五档行情数据结构
+ 分时图数据结构
+ K线图数据结构
+ 行情状态数据结构

### DB存储
+ 原始行情数据（需要存储）
+ 动态行情（**不需要存储，直接从原始行情数据中取出**）
+ 五档行情（**不需要存储，直接从原始行情数据中取出**）
+ **分时图行情与1分钟K线图行情**（需要存储，分时与1分钟K线是否可以合并？？）
+ 5分钟K线图行情（需要存储）
+ 15分钟K线图行情（需要存储）
+ 30分钟K线图行情（需要存储）
+ 60分钟K线图行情（需要存储）
+ 240分钟K线图行情（需要存储）
+ 日K线图行情（需要存储）
+ 周K线图行情（需要存储）
+ 月K线图行情（需要存储）

### redis存储
+ 原始行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: 原始行情数据对象
  + 存储 **2个交易** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 动态行情数据
  + 不需要存储在redis中，需要时直接从原始行情中取最新的；
+ 五档行情数据
  + 不需要存储在redis中，需要时直接从原始行情中取最新的；
+ 分时图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: 分时图行情对象
  + 存储 **1个交易** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 1分钟K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **2个交易** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 5分钟K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **4个交易** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 15分钟K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **7个交易** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 30分钟K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **15个交易** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 60分钟K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **30个交易日** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 240分钟K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **90个交易日** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 日K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **600个交易日** 的行情数据；新的一天行情开始时，删除最早的一天的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 周K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **所有** 的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 月K线图行情数据
  + 使用hash数据结构，key：字符串；hfield:行情时间的长整型；hvalue: K线行情对象
  + 存储 **所有** 的行情数据；
  + hfield会以list方式存储在本地内存中，用于快速检索；
  + 过期时间：不过期，持久化存盘；
+ 行情状态数据
  + 使用string存储行情状态信息；
  + 过期时间：不过期，持久化存盘；

### 行情计算方法与流程
+ 动态行情数据
  + 行情接入时：从redis的原始行情中取最新的一条行情数据转换成动态行情返回；
  + 新行情过来时：直接把新原始行情数据转换成动态行情返回；
+ 五档行情数据
  + 行情接入时：从redis的原始行情中取最新的一条行情数据转换成动态行情返回；
  + 新行情过来时：直接把新原始行情数据转换成五档行情返回；
+ 分时图行情数据
  + 行情接入时：把redis中的分时图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的分时图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的分时图对象；如果新行情在该分时图对象范围内就合并并更新redis,DB;没有在该分时图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔几分种以上，可以用上一个行情数据的close来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
  + 分时图：以每分钟的收盘价作为行情；
+ 1分钟K线图行情数据
  + 行情接入时：把redis中的1分钟K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的1分钟K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的1分钟K线图对象；如果新行情在该1分钟K线图对象范围内就合并并更新redis,DB;没有在该1分钟K线图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔几分种以上，可以用上一个行情数据来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 5分钟K线图行情数据
  + 行情接入时：把redis中的5分钟K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的5分钟K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的5分钟K线图对象；如果新行情在该5分钟K线图对象范围内就合并并更新redis,DB;没有在该5分钟K线图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔5分种以上，可以用上一个行情数据来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 15分钟K线图行情数据
  + 行情接入时：把redis中的15分钟K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的15分钟K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的15分钟K线图对象；如果新行情在该15分钟K线图对象范围内就合并并更新redis,DB;没有在该5分钟K线图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔15分种以上，可以用上一个行情数据来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 30分钟K线图行情数据
  + 行情接入时：把redis中的30分钟K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的30分钟K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的30分钟K线图对象；如果新行情在该30分钟K线图对象范围内就合并并更新redis,DB;没有在该30分钟K线图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔30分种以上，可以用上一个行情数据来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 60分钟K线图行情数据
  + 行情接入时：把redis中的60分钟K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的60分钟K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的60分钟K线图对象；如果新行情在该60分钟K线图对象范围内就合并并更新redis,DB;没有在该60分钟K线图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔60分种以上，可以用上一个行情数据来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 240分钟K线图行情数据
  + 只需要取三个时间点的数据；
  + 行情接入时：把redis中的240分钟K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的240分钟K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的240分钟K线图对象；如果新行情在该240分钟K线图对象范围内就合并并更新redis,DB;没有在该240分钟K线图范围内就创建新分时图对象保存到redis,db；
  + 新行情过来时，与上一个行情相隔240分种以上，可以用上一个行情数据来创建中间缺失的部分；如果是暂停后的第一个行情，也要判断该行情到暂停终止的相隔时间
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 日K线图行情数据
  + 行情接入时：把redis中的日K线图所有行情数据取出转换成list返回；
  + 行情再次切换接入时：把redis中的日K线图行情数据取出转换成list返回，只返回上次离开后缺失的部分，使用行情时间长整型作为标识与参数；
  + hfield列表存在本地内存中，用于排序或删除、快速检索；
  + 新行情过来时：从redis中取出最新的日K线图对象；如果新行情在该日K线图对象范围内就合并并更新redis,DB;没有在日K线图范围内就创建新分时图对象保存到redis,db；
  + 只要是推送的行情都正常接收（这些都是过滤后的行情，用全年可交易时间段来控制）；
+ 周K线图行情数据

+ 月K线图行情数据

+ 行情状态数据

### 可交易时间计算
从全年的时间中排除不可交易时段（每天休息时段，节假日等）
