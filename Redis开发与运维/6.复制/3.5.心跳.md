心跳
===============================================================
主从节点在建立复制后，它们之间维护着 **长连接** 并 **彼此发送心跳命令**，主从心跳判断机制：
1. 主从节点彼此都有心跳检测机制，**各自模拟成对方的客户端进行通信**，通过 **`client list`命令** 查看复制相关客户端信息，
**主节点** 的连接状态为 **`flags=M`**， **从节点** 连接状态为 **`flags=S`**。

2. 主节点默认每隔 **10秒** 对从节点发送`ping`命令，判断从节点的存活性和连接状态。
可通过参数 **`repl-ping-slave-period`** 控制发送频率。

3. 从节点在主线程中每隔 **1秒** 发送 **`replconf ack {offset}`** 命令，给主节点上报自身当前的复制偏移量。
`replconf`命令主要作用如下：
  + 实时监测主从节点网络状态；
  + 上报自身复制偏移量，检查复制数据是否丢失，如果从节点数据丢失，再从主节点的复制缓冲区中拉取丢失数据；
  + 实现保证从节点的数量和延迟性功能，通过`min-slaves-to-write`、`min-slaves-max-lag`参数配置定义；

主节点根据`replconf`命令判断从节点超时时间，体现在`info replication`统计中的 **`lag`** 信息中，`lag`表示
**与从节点最后一次通信延迟的秒数**，正常延迟应该在0和1之间。如果超过`repl-timeout`配置的值（**默认60秒**），
则判断从节点下线并断开复制客户端连接。即使主节点判定从节点下线后，如果从节点重新恢复，心跳检测会继续进行。
