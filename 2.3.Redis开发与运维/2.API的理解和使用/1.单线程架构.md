单线程架构
==============================================================
Redis使用了 **单线程架构** 和 **I/O多路复用模型** 来实现高性能的内存数据库服务。
这里通过 **多个客户端** 命令调用的例子说明 **Redis单线程命令处理机制**，接着分析
Redis单线程模型为什么性能如此之高，最终给出为什么 **理解单线程模型是使用和运维Redis的关键**。

### 引出单线程模型
现在开启了三个redis-cli客户端同时执行命令。

客户端1设置一个字符串键值对：
```shell
127.0.0.1:6379> set hello world
```
客户端2对counter做自增操作：
```shell
127.0.0.1:6379> incr counter
```
客户端3对counter做自增操作：
```shell
127.0.0.1:6379> incr counter
```
因为Redis是单线程来处理命令的，所以 **一条命令从客户端达到服务端不会立刻被执行**，
**所有命令都会进入一个队列中，然后逐个被执行**。所以上面3个客户端命令的 **执行顺序是不确定的**，
但是 **可以确定不会有两条命令被同时执行**，所以两条incr命令无论怎么执行最终结果都是2，
不会产生并发问题，这就是 **Redis单线程的基本模型**。 

但是像发送命令、返回结果、命令排队肯定不像描述的这么简单，**Redis使用了I/O多路复用技术来**
**解决I/O的问题**。

### 为什么单线程还能这么快
为什么Redis使用单线程模型会达到每秒万级别的处理能力呢？归结为三点：
+ **纯内存访问**，Redis将所有数据放在内存中，内存的响应时长大约为 **100纳秒**，
这是Redis达到每秒万级别访问的重要基础。
+ **非阻塞I/O**，Redis **使用epoll作为I/O多路复用技术的实现**，再加上Redis自己的事件处理模型将epoll中的连接、
读写、关闭都转换为事件，不在网络I/O上浪费过多时间。
+ **单线程避免了线程切换和竞态产生的消耗**。





