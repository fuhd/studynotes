部分复制
===============================================================
部分复制主要是Redis **针对全量复制的过高开销做出的一种优化措施**，使用 **`psync {runId} {offset}`** 命令实现。
当从节点（slave）正在复制主节点（master）时，**如果出现网络闪断或者命令丢失等异常情况时**，从节点会向主节点
要求补发丢失的命令数据，**如果主节点的复制积压缓冲区内存在这部分数据则直接发送给从节点，这样就可以保持主从节点
复制的一致性。补发的这部分数据一般远远小于全量数据，所以开销很小**。部分复制的流程如下：

1. 当主从节点之间网络出现中断时，如果超过 **`repl-timeout`** 时间，主节点会认为从节点故障并中断复制连接。

2. 主从连接中断期间主节点依然响应命令，但因复制连接中断命令无法发送给从节点，不过主节点内部存在的复制积压缓冲区，
   依然可以保存最近一段时间的写命令数据，默认最大缓存1MB。

3. 当主从节点网络恢复后，从节点会再次连上主节点。

4. 当主从连接恢复后，由于从节点之前保存了自身已复制的 **偏移量** 和 **主节点的运行ID**。
   因此会把它们当作 **`psync`参数** 发送给主节点，要求进行部分复制操作。

5. 主节点接到 **`psync`** 命令后首先 **核对参数`runId`是否与自身一致**，如果一致，说明之前复制的是当前主节点；
   之后根据参数 **`offset`** 在自身复制积压缓冲区查找，如果偏移量之后的数据存在缓冲区中，则对从节点发送 **`+CONTINUE`**
   响应，表示可以进行部分复制。

6. 主节点根据偏移量所复制积压缓冲区里的数据发送给从节点，保证主从复制进入正常状态。
