维度设计高级主题
================================================================================
## 维度整合
**数据仓库的定义：数据仓库是一个面向主题的、集成的、非易失的且随时间变化的数据集合，用来支持管理
人员的决策**。其中 **集成** 是数据仓库的四个特性中最重要的一个。

数据由面向应用的操作型环境进入数据仓库后，需要进行数据集成。将面向应用的数据转换为面向主题的数据
仓库数据，本身就是一种集成。具体体现在如下几个方面：
+ **命名规范的统一**。表名、字段名等统一。
+ **字段类型的统一**。相同和相似字段的字段类型统一。
+ **公共代码及代码值的统一**。公共代码及标志性字段的数据类型、命名方式等统一。
+ **业务含义相同的表的统一**。主要依据高内聚、低耦合的理念，在物理实现中，将业务关系大、源系统影
响差异小的表进行 **整合**；将业务关系小、源系统影响差异大的表进行 **分而置之**。通常有如下几种
集成方式：
    - **采用主从表的设计方式**，将两个表或多个表都有的字段放在主表中（主要基本信息），从属信息
    分别放在各自的从表中。对于主表中的主键，要么采用复合主键、源主键和系统或表区别标志；要么采用
    唯一主键、“源主键和系统或表区别标志”生成新的主键。**通常建议采用复合主键的方式**。
    - **直接合并**，共有信息和个性信息都放在同一个表中。如果表字段的重合度较低，则会出现大量空
    值，对于存储和易用性会有影响，需谨慎选择。
    - **不合并**，因为源表的表结构及主键等差异很大，无法合并，使用数据仓库里的多个表存放各自的
    数据。

维表的整合有两种表现形式：
+ **第一种是垂直整合（就是把数据列整合到一个表中或者主从表）**，即不同的来源表包含相同的数据集，
只是存储的信息不同。
+ **第二种是水平整合（就是把数据行整合到一个表中）**，即不同的来源表包含不同的数据集，不同子集之
间无交叉，也可以存在部分交叉。

有整合就有拆分，到底是整合还是拆分，由多种因素决定。下面两节讨论维度的水平拆分和垂直拆分。

## 水平拆分
如何设计维度？针对此问题，主要有两种解决方案：**方案1是将维度的不同分类实例化为不同的维度，同时在
主维度中保存公共属性； 方案2是维护单一维度，包含所有可能的属性**。在设计过程中需要重点考虑以下三
个原则：
+ **扩展性**：当源系统、业务逻辑变化时，能通过较少的成本快速扩展模型，保持核心模型的相对稳定性。
+ **效能**：在性能和成本方面取得平衡。通过牺牲一定的存储成本，达到性能和逻辑的优化。
+ **易用性**：模型可理解性高、访问复杂度低。用户能够方便地从模型中找到对应的数据表，并能够方便地
查询和分析。

根据数据模型设计思想，在对维度进行水平拆分时，主要考虑如下两个依据。

**第一个依据是维度的不同分类的属性差异情况。当维度属性随类型变化较大时，将所有可能的属性建立在一
个表中是不切合实际的，也没有必要这样做，此时建议采用方案1**。定义一个主维度用于存放公共属性；同
时定义多个子维度，其中除了包含公共属性外，还包含各自的特殊属性。**通过扩展子维度的方式，保证了模
型的扩展性**。

**第二个依据是业务的关联程度。两人个相关性较低的业务，耦合在一起弊大于利，对模型的稳定性和易用性
影响较大**。在易用性方面，会给数据使用方造成困扰。


