Cloudera Search概述
================================================================================
Cloudera Search为存储在 **Hadoop、HBase** 中的数据提供了简单、自然的语言访问。终端用户和其他
web服务可以使用全文检索和分面挖掘来研究文本、半结构化和结构化数据，以及快速地过滤和聚合它以获得业务
洞察力，**而不需要SQL或编程技能**。

Cloudera Search是 **Apache Solr完全集成在Cloudera平台中的产品**，充分利用了CDH中包含的灵活、
可扩展且强大的存储系统和数据处理框架。这 **消除了跨基础架构移动大型数据集以执行业务任务的需要**。
它进一步实现了简化的数据管道，其中搜索和文本匹配是较大工作流程的一部分。

Cloudera Search合并了Apache Solr，其中包括Apache Lucene，SolrCloud，Apache Tika和Solr
Cell，**Cloudera Search包含在CDH 5及更高版本中**。

下表介绍了Cloudera搜索功能：

| 功能 | 描述 |
| :------------- | :------------- |
| 使用Cloudera Manager进行统一管理和监控 | Cloudera Manager为CDH和Cloudera Search提供统一和集中的管理和监控。 Cloudera Manager简化了搜索服务的部署，配置和监控。 许多现有的搜索解决方案缺乏管理和监控能力，并且无法深入了解利用率，系统健康状况，趋势和其他可支持性方面。 |
| 索引存储在HDFS中 | Cloudera Search与HDFS集成在一起，实现了健壮，可扩展且自我修复的索引存储。 由Solr / Lucene创建的索引直接使用数据写入HDFS，而不是本地磁盘，从而提供容错和冗余。Cloudera Search经过优化，可在HDFS中快速读取和写入索引，同时通过标准Solr机制提供索引并进行查询。 由于数据和索引位于同一位置，因此数据处理不需要传输或单独管理的存储。 |
| 通过MapReduce创建批索引 | 为了便于大数据集的索引创建，Cloudera Search内置了MapReduce作业，用于索引存储在HDFS或HBase中的数据。因此，MapReduce的线性可伸缩性应用于索引管道，从而减轻Solr索引服务资源的负担。 |
| 数据摄取的实时和可伸缩索引 | Cloudera Search提供与Flume的集成以支持接近实时的索引。 当新事件通过Flume层次结构并写入HDFS时，可以将这些事件直接写入Cloudera Search索引器。此外，Flume支持路由事件，过滤和传递给CDH的数据注释。 这些功能可与Cloudera Search一起使用，以改进索引分片，索引分隔和文档级访问控制。 |
| 通过Hue轻松进行互动和数据探索 | Cloudera搜索GUI作为Hue插件提供，使用户能够交互式查询数据，查看结果文件并进行分面探索。 Hue还可以安排常规查询和探索索引文件。 此GUI使用基于标准Solr API的Cloudera Search API。 拖放仪表板界面使任何人都可以轻松创建搜索仪表板。 |
| 简化了搜索工作负载的数据处理 | Cloudera搜索可以使用Apache Tika进行解析和编写许多标准文件格式的索引。此外，Cloudera搜索支持Avro、Hadoop Sequence和Snappy文件格式映射，以及日志文件格式、JSON、XML和HTML。Cloudera Search还提供Morphlines，这是一个易于使用的预建库，包含常用数据预处理功能。 Morphlines简化了多种文件格式索引的数据准备工作。 用户可以轻松实现Flume，Kafka和HBase的Morphlines，或者将其他应用程序（如MapReduce或Spark作业）重复使用相同的Morphlines。 |
| HBase搜索 | Cloudera Search与HBase集成，支持全文搜索HBase数据，而不会影响HBase性能或复制数据存储。 监听器监控来自HBase RegionServers的复制事件流，并捕获每个写入或更新复制的事件，从而启用抽取和映射（例如，使用Morphlines）。 然后将事件直接发送到Solr以便在HDFS中进行索引和存储，使用与Cloudera Search的其他索引工作负载相同的过程。 这些索引可以立即提供，从而实现HBase数据的自由文本搜索。|

### Cloudera搜索的工作原理
在接近实时的索引用例中，例如日志或事件流分析，Cloudera Search索引通过Apache Flume，Apache
Kafka，Spark Streaming或HBase流式传输的事件。字段和事件映射到标准Solr可索引架构。 Lucene索
引传入事件，并将索引写入并存储在HDFS中的标准Lucene索引文件中。在HDFS分区中的常规流量事件路由和
数据存储也可以应用。事件可以通过多个Flume代理进行路由和流式传输，并写入单独的Lucene索引器中，这
些索引器可以写入单独的索引碎片，以便在索引时实现更好的扩展并在搜索时实现更快的响应。

索引从HDFS加载到Solr核心，就像Solr从本地磁盘读取一样。Cloudera Search设计的不同之处在于HDFS的
健壮，分布式和可扩展的存储层，它有助于消除代价高昂的停机时间，并且在不移动数据的情况下实现跨工作负载
的灵活性。然后可以通过标准的Solr API或通过简单的搜索GUI应用程序将搜索查询提交给Solr，该应用程序可
以在Hue中部署，包含在Cloudera Search中。

Cloudera Search面向批处理的索引功能可以满足在批量上传文件或大数据集中进行搜索的需求，这些数据集的
更新频率较低，而且不需要近实时索引。它还可以方便地用于重新索引（独立Solr中常见的痛点）或用于按需数据
探索的临时索引。通常，批量索引定期完成（小时，每日，每周等），作为较大工作流程的一部分。

对于这种情况，Cloudera Search包含基于MapReduce或Spark的高度可扩展的索引工作流程。针对HDFS中的
指定文件或文件夹或HBase中的表启动MapReduce或Spark工作流，并在映射阶段执行字段提取和Solr模式映射。
Reducers使用嵌入式Lucene将数据作为单个索引或索引碎片写入，具体取决于您的配置和首选项。索引存储在
HDFS中之后，可以使用标准的Solr机制来查询它们，如前面关于近实时索引用例所述。您还可以配置这些批量索
引选项，以将新索引数据直接发布到由Solr提供的实时活动索引中。这个GoLive选项可以在不中断服务的情况下
启用简化的数据管道来定期处理传入的批量更新。

**Lily HBase Indexer Service是一个灵活的，可扩展的，容错的，事务性的，接近实时的系统，用于处理
连续的HBase单元更新到实时搜索索引。Lily HBase Indexer使用Solr来索引存储在HBase中的数据**。随着
HBase向HBase表格单元应用插入，更新和删除操作，索引器使用标准HBase复制功能使Solr与HBase表格内容保
持一致。索引器支持灵活的自定义应用程序特定规则来提取，转换和加载HBase数据到Solr。 Solr搜索结果可以
包含columnFamily：限定符链接回存储在HBase中的数据。这样应用程序可以使用搜索结果集来直接访问匹配的原
始HBase单元。**索引和搜索不会影响HBase的操作稳定性或写入吞吐量**，因为索引和搜索过程与HBase是分开
的和异步的。
