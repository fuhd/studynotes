解决安装问题
================================================================================
本主题介绍常见安装问题和建议的解决方案。

## 1.无法启动由cloudera-manager-installer.bin报告的服务器
cloudera-manager-installer.bin报告“无法启动服务器”。/var/log/cloudera-scm-server/cloudera-scm-server.log
包含一条消息开头由：java.lang.ClassNotFoundException：com.mysql.jdbc.Driver ...

### 1.1.可能的原因
您可能启用了SELinux。

### 1.2.可能的解决方案
通过在Cloudera Manager服务器主机上运行：
```shell
$ sudo setenforce 0
```
来禁用SELinux。要永久禁用它，请编辑 **/etc/selinux/config**。

## 2.安装中断并且安装程序不重新启动
安装中断并且安装程序不重新启动。

### 2.1.可能的原因
你需要做一些手动清理。

### 2.2.可能的解决方案
请参阅 **卸载Cloudera Manager和托管软件**。

## 3.Cloudera Manager Server无法启动MySQL
Cloudera Manager Server无法启动，并且服务器配置为使用MySQL数据库来存储有关服务配置的信息。

### 3.1.可能的原因
**表可能使用ISAM引擎进行配置**。如果服务器的表使用MyISAM引擎进行配置，则服务器不会启动，并且日志
文件中会显示如下所示的错误消息：
```
Tables ... have unsupported engine type ... . InnoDB is required.
```

### 3.2.可能的解决方案
确保配置了InnoDB引擎，而不是MyISAM引擎。要检查你的表使用了什么引擎，从MySQL shell运行以下命令：
```shell
mysql> show table status;
```
有关更多信息，请参阅 **为Cloudera软件安装和配置MySQL**。

## 4.代理无法连接到服务器
代理无法连接到服务器。在 **/var/log/cloudera-scm-agent/cloudera-scm-agent.log** 中收到错误
113（“无主机路由”）。

### 4.1.可能的原因
您可能启用了SELinux或iptables。

### 4.2.可能的解决方案
检查服务器主机上的 **/var/log/cloudera-scm-server/cloudera-scm-server.log** 和代理主机上的
**/var/log/cloudera-scm-agent/cloudera-scm-agent.log**。禁用SELinux和iptables。

## 5.群集主机不显示
在安装或更新向导中单击“查找主机”时，某些群集主机不会显示。

### 5.1.可能的原因
您可能有网络连接问题。

### 5.2.可能的解决方案
+ 确保所有群集主机都已打开SSH端口22。
+ 检查连接丢失的其他常见原因，例如防火墙和SELinux的干扰。

## 6.安装或更新向导中的“拒绝访问”
在活动监视器或报告管理器的数据库配置期间，在安装或更新向导中的“拒绝访问”。

### 6.1.可能的原因
主机名映射或权限设置不正确。

### 6.2.可能的解决方案
1. 有关主机名配置，请参阅 **配置网络名称**。
2. 有关权限，请确保您输入到向导中的值与您在配置数据库时使用的值相匹配。**作为数据库主机名输入到向导中的
值必须与您在配置数据库时为主机名（如果有）输入的值相匹配**。例如，如果您在创建数据库时输入了以下内容：
    ```sql
    grant all on activity_monitor.* TO 'amon_user'@'myhost1.myco.com' IDENTIFIED BY 'amon_password';
    ```
   您在此处为数据库主机名输入的值必须是myhost1.myco.com。如果您未指定主机，或者使用通配符来允许从任何
   主机进行访问，则可以输入完全限定的域名（FQDN）或`localhost`。 例如，如果你输入：
    ```sql
    grant all on activity_monitor.* TO 'amon_user'@'%' IDENTIFIED BY 'amon_password';
    ```
   您为数据库主机名输入的值可以是FQDN或`localhost`。

## 7.数据库无法启动。
活动监视器，报表管理器或服务监视器数据库无法启动。

### 7.1.可能的原因
MySQL的`binlog`格式问题。

### 7.2.可能的解决方案
在 **/etc/my.cnf** 中设置 **binlog_format = mixed**。有关更多信息，请参阅此MySQL错误报告。
另请参阅 **步骤4：安装和配置数据库**。

## 8.Cloudera服务无法启动
Cloudera服务无法启动。

### 8.1.可能的原因
Java可能未安装或可能安装在自定义位置。

### 8.2.可能的解决方案
有关解决此问题的更多信息，请参阅 **配置定制Java Home位置**。

## 9.Activity Monitor显示BAD的状态
活动监视器在Cloudera Manager管理控制台中显示 **BAD** 状态。日志文件包含以下消息：
```
ERROR 1436 (HY000): Thread stack overrun: 7808 bytes used of a 131072 byte stack, and 128000 bytes needed.
Use 'mysqld -O thread_stack=#' to specify a bigger stack.
```

### 9.1.可能的原因
MySQL线程堆栈太小。

### 9.2.可能的解决方案
1. 将 **my.cnf** 中的 **thread_stack** 值更新为 **256KB**。my.cnf文件通常位于 **/etc** 或
**/etc/mysql** 中。
2. 重新启动mysql服务：
    ```shell
    $ sudo service mysql restart
    ```
3. 重新启动活动监视器。

## 10.活动监视器无法启动
活动监视器无法启动。日志包含错误 **read-committed isolation not safe for the statement binlog
format.**。

### 10.1.可能的原因
**binlog_format** 未设置为混合。

### 10.2.可能的解决方案
修改 **mysql.cnf** 文件以包含为 `Cloudera Software安装和配置MySQL` 中指定的 **binlog** 格式条目。

## 11.尝试重新安装较低版本的Cloudera Manager失败
尝试使用 **yum** 重新安装较低版本的CDH或Cloudera Manager失败。

### 11.1.可能的原因
可以安装，卸载并重新安装CDH和Cloudera Manager。在某些情况下，这不会按预期完成。如果安装Cloudera
Manager6和CDH6，然后卸载Cloudera Manager和CDH，然后尝试安装CDH5和Cloudera Manager5，则不正确
的缓存信息可能会导致安装不兼容的Oracle JDK版本。

### 11.2.可能的解决方案
清除yum缓存中的信息：
1. 连接到CDH主机。
2. 执行以下任一命令：
    ```shell
    $ yum --enablerepo='*' clean all
    ```
   或
    ```shell
    $ sudo rm -rf /var/cache/yum/cloudera*
    ```
3. 清除缓存后，继续安装。

## 12.创建Hive Metastore数据库表命令失败
由于转义字符串的问题，创建Hive Metastore数据库表命令失败。

### 12.1.可能的原因
PostgreSQL版本9及更高版本需要针对Hive进行特殊配置，因为 **standard_conforming_strings** 属性的
默认值发生向后不兼容的更改。直到PostgreSQL9.0的版本默认`off`，但从版本9.0开始默认`on`。

### 12.2.可能的解决方案
作为管理员用户，请使用以下命令关闭 **standard_conforming_strings** ：
```sql
ALTER DATABASE <hive_db_name> SET standard_conforming_strings = off;
```

## 13.Oracle无效标识符
如果您正在使用Oracle数据库，并且 **Cloudera Navigator Analytics> Audit> Activity** 选项卡
显示“**No data available**”，并且在日志中包含对 **dbms_crypto** 的引用的查询存在有关“无效标识
符”的Oracle错误。

### 13.1.可能的原因
您尚未向 **sys.dbms_crypto** 授予执行权限。

### 13.2.可能的解决方案
运行：
```sql
GRANT EXECUTE ON sys.dbms_crypto TO nav;
```
`nav`是Navigator Audit Server数据库的用户。
