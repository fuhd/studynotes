Kafka生产者——向Kafka写入数据
===================================================================================
## 1.生产者概览

Kafka发消息的主要步骤：

![Kafka生产者组件图](img/1.png)

我们从创建一个ProducerRecord对象开始，**ProducerRecord对象** 需要包含 **目标主题** 和 **要发送的
内容**。我们还可以指定 **键** 或 **分区**。在发送ProducerRecord对象时，**生产者要先把键和值对象序列
化成字节数组**，这样它们才能够在网络上传输。

接下来，数据被传给 **分区器**。如果之前在 **ProducerRecord对象里指定了分区，那么分区器就不会再做任
何事情**，直接把指定的分区返回。**如果没有指定分区，那么分区器会根据ProducerRecord对象的键来选择一
个分区**。选好分区以后，生产者就知道该往 **哪个主题和分区** 发送这条记录了。紧接着，这条记录被添加到
一个 **记录批次** 里，这个批次里的所有消息会被发送到相同的主题和分区上。 有一个 **独立的线程** 负责把
这些记录批次发送到相应的broker上。

服务器在收到这些消息时会 **返回一个响应**。如果消息成功写入Kafka，就返回一个 **RecordMetaData对象**，
它包含了 **主题和分区信息**，以及记录在分区里的 **偏移量**。如果写入失败，则会返回一个错误。**生产者
在收到错误之后会尝试重新发送消息，几次之后如果还是失败，就返回错误信息**。

## 2.创建Kafka生产者
Kafka生产者有3个必选的属性：

### 2.1.bootstrap.servers 
该属性指定 **broker的地址清单**，地址的格式为：`host:port`。清单里 **不需要包含所有的broker地址**，
生产者会从给定的broker里查找到其他broker的信息，一旦其中一个宕机，生产者仍然能够连接到集群上。

### 2.2.key.serializer
broker希望接收到的消息的 **键** 和 **值** 都是 **字节数组**。生产者接口允许使用参数化类型，**因此可以
把Java对象作为键和值发送给broker**。这样的代码具有良好的可读性，不过生产者需要知道如何把这些Java对
象转换成字节数组。**`key.serializer`必须被设置为一个实现了`org.apache.kafka.common.serialization.Serializer`
接口的类**，生产者会使用这个类把键对象序列化成字节数组。**Kafka客户端默认提供了`ByteArraySerializer`、
`StringSerializer`和`IntegerSerializer`**。

