broker配置
================================================================================
**Kafka发行包里自带的配置样本可以用来安装单机服务**，但并不能满足大多数安装场景的要求。Kafka有
很多配置选项，涉及安装和调优的方方面面。不过大多数调优选项可以使用默认配置，除非你对调优有特别的
要求。

## 1.常规配置
有一些配置选项，在单机安装时可以直接使用默认值，但在部署到其他环境时要格外小心。这些参数是单个服
务器最基本的配置，**它们中的大部分需要经过修改后才能用在集群里**。

### 1.1.broker.id
**每个broker都需要有一个标识符，使用broker.id来表示。它的默认值是0，也可以被设置成其他任意整数。
这个值在整个Kafka集群里必须是唯一的**。这个值可以任意选定，如果出于维护的需要，可以在服务器节点
间交换使用这些ID。**建议把它们设置成与机器名具有相关性的整数**，这样在进行维护时，将ID号映射到机
器名就没有那么麻烦了。例如，如果机器名包含唯一性的数字（比如`host1.example.com`、
`host2.example.com`、`host3.example.com`），那么用这些数字来设置broker.id就再好不过了。

### 1.2.port
**如果使用配置样本来启动Kafka，它会监听9092端口**。修改port配置参数可以把它设置成其他任意可用
的端口。**要注意，如果使用1024以下的端口，需要使用root权限启动Kafka，不过不建议这么做**。

### 1.3.zookeeper.connect
**用于保存broker元数据的Zookeeper地址是通过zookeeper.connect来指定的**。`localhost:2181`
表示这个Zookeeper是运行在本地的2181端口上。**该配置参数是用冒号分隔的一组hostname:port/path
列表**，每一部分的含义如下：
+ `hostname`是Zookeeper服务器的机器名或IP地址；
+ `port`是可选的Zookeeper的客户端连接端口；
+ `/path`是可选的Zookeeper路径，作为Kafka集群的chroot环境。如果不指定。默认使用根路径；

**如果指定的chroot路径不存在，broker会在启动的时候创建它**。
```
为什么使用chroot路径？

在Kafka集群里使用chroot路径是一种最佳实践。Zookeeper群组可以共享给其他应用程序，即使还有其他Kafka集群存在，也不会产生
冲突。最好是在配置文件里指定一组Zookeeper服务器。用分号把它们隔开。一旦有一个Zookeeper服务器宕机，broker可以连接到
Zookeeper群组的另一个节点上。
```

### 1.4.log.dirs
**Kafka把所有消息都保存在磁盘上，存放这些日志片段的目录是通过log.dirs指定的。它是一组用逗号分
隔的本地文件系统路径**。如果指定了多个路径，那么broker会根据“**最少使用**”原则，**把同一个分区
的日志片断保存到同一个路径下。要注意，broker会往拥有最少数目分区的路径新增分区，而不是往拥有最小
磁盘空间的路径新增分区**。

### 1.5.num.recovery.threads.per.data.dir
对于如下3种情况，**Kafka会使用可配置的线程池来处理日志片段**：
+ 服务器正常启动，用于打开每个分区的日志片段；
+ 服务器崩溃后重启，用于检查和截短每个分区的日志片段；
+ 服务器正常关闭，用于关闭日志片段；

**默认情况下，每个日志目录只使用一个线程**。因为这些线程只是在服务器启动和关闭时会用到，所以完全
**可以设置大量的线程来达到并行操作的目的。特别是对于包含大量分区的服务器来说，一旦发生崩溃，在进
行恢复时使用并行操作可能会省下数小时的时间。设置此参数时需要注意，所配置的数字对应的是log.dirs
指定的单个日志目录**。也就是说，如果`num.recovery.threads.per.data.dir`被设置为8，并且
`log.dirs`指定了3个路径，那么总共需要24个线程。










