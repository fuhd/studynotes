云主机的主机名造成的问题
===================================================================================
## 1.问题描述
本人使用华为云部署了一套HDP3.1的大数据开发环境。部署之后发现YARN服务告警：
```
Timeline Service V2.0 Reader not starting
```
通过YARN查找日志发现相关日志：
```
KeeperErrorCode = NoNode for /atsv2-hbase-unsecure/meta-region-server
```
最后查找到`server04.xxxx.com`这台服务器的HBase RegonServer一直访问不通（Timeline Service
的数据一直存储在HBase中）。

## 2.原因
通过互联网查找广大网友踩过的坑，发现跟云主机的hosts文件配置有关系。因为我使用的华为云，在创建云主
机时根据自己输入的机器名在hosts文件中初始化了主机名。

如果我更改了hosts（新增了一些配置，另外删除了初始化时指定的`127.0.0.1  xxx`），重启主机后，发现删除
的这个配置又加回来了。恰好`server04.xxxx.com`这台主机设置的是：`masternode`。这可能对Hbase造成
影响。

## 3.解决
直接只对`/etc/hosts`文件进行修改，重启系统后删除的记录又还原了。主要是系统配置了
`manage_etc_hosts`，如果要修改hosts的话：
+ 需要先对`/etc/cloud/templates/hosts.redhat.tmpl`进行修改，比如注释掉：
    ```shell
    # 127.0.0.1 {{fqdn}} {{hostname}}

    # ::1 {{fqdn}} {{hostname}}
    ```
    这里我注释了 `127.0.0.1 {{fqdn}} {{hostname}}`，`::1 {{fqdn}} {{hostname}}`。

+ 然后在`/etc/cloud/cloud.cfg`文件中注释掉`manage_etc_hosts`的值。
    ```yml
    # manage_etc_hosts: localhost
    ```

```
注：

为了干净的Hadoop环境，我最终是重装系统，再重装大数据环境解决的！！！！！！！！！！！！！！！！！
重装系统后就马上按上面的操作执行了一遍。
```