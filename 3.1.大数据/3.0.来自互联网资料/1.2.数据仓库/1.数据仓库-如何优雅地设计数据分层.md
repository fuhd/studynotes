数据仓库-如何优雅地设计数据分层
================================================================================
## 1.为什么要分层
我们对数据进行分层的一个主要原因就是希望在管理数据的时候，能对数据有一个更加清晰的掌控，详细来讲，
主要有下面几个原因：
1. **清晰数据结构**：每一个数据分层都有它的作用域，这样我们在使用表的时候能更方便地定位和理解。
2. **数据血缘追踪**：简单来讲可以这样理解，我们最终给业务呈现的是能直接使用的一张业务表，但是它
的来源有很多，如果有一张来源表出问题了，我们希望能够快速准确地定位到问题，并清楚它的危害范围。
3. **减少重复开发**：规范数据分层，开发一些通用的中间层数据，能够减少极大的重复计算。
4. **把复杂问题简单化**：将一个复杂的任务分解成多个步骤来完成，每一层只处理单一的步骤，比较简单和
容易理解。而且便于维护数据的准确性，当数据出现问题之后，可以不用修复所有的数据，只需要从有问题的步
骤开始修复。
5. **屏蔽原始数据的异常**。
6. **屏蔽业务的影响**，不必改一次业务就需要重新接入数据。

数据体系中的各个表的依赖就像是电线的流向一样，我们都希望它是规整、流向清晰、便于管理的，如下图：

![数据分层1](img/1.png)

但是，最终的结果大多却是依赖复杂、层级混乱，想梳理清楚一张表的生成途径会比较困难，如下图：

![数据分层2](img/2.png)

## 2.怎样分层

### 2.1.理论
我们从理论上来做一个抽象，可以把数据仓库分为下面三个层，即：**数据运营层**、**数据仓库层** 和 **数
据产品层**。

![数据分层3](img/3.png)

#### 2.1.1.ODS全称是Operational Data Store，操作数据存储
“面向主题的”，**数据运营层**，也叫 **ODS层**，是最接近数据源中数据的一层，数据源中的数据，经过抽取、
洗净、传输，也就说传说中的 **ETL** 之后，装入本层。本层的数据，总体上大多是按照源头业务系统的分类方
式而分类的。

但是，**这一层面的数据却不等同于原始数据**。在源数据装入这一层时，要进行诸如 **去噪**（例如有一条数据
中人的年龄是300岁，这种属于异常数据，就需要提前做一些处理）、**去重**（例如在个人资料表中，同一ID却有两
条重复数据，在接入的时候需要做一步去重）、**字段命名规范等** 一系列操作。



































dd
