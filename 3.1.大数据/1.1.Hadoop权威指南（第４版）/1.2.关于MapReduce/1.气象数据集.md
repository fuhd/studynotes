气象数据集
================================================================================
**MapReduce是一种可用于数据处理的编程模型**。Hadoop可以运行各种语言版本的MapReduce程序。
**MapReduce程序本质上是并行运行的**，因此可以将大规模的数据分析任务分发给任何一个拥有足够多机器
的数据中心。MapReduce的优势在于处理大规模数据集，所以这里先来看一个数据集。

在我们的例子里，要写一个 **挖掘气象数据的程序**。分布在全球各地的很多气象传感器每隔一小时收集气
象数据和收集大量日志数据，由于我们希望处理所有这些数据，而且这些数据是 **半结构化** 的且是按照记
录方式存储的，因此非常适合用MapReduce来分析。

我们使用的数据来自 **美国国家气象数据中心**（`National Climatic Data Center`，简称`NCDC`，
`http://www.ncdc.noaa.gov/`）。这些数据 **按行** 并以 **ASCII格式** 存储，其中每一行是一
条记录。该存储格式支持丰富的气象要素，其中许多要素可以选择性地列入收集范围或其数据所需的存储长是
可变的。

下面范例显示了一行采样数据，其中重要字段加了注释。这一行数据被分成很多行以突出每个字段，但在实际
文件中，这些字段合并成一行，没有任何分隔符。
```
0057
332130                      #USAF weather station identifier
99999                       #WBAN weather station identifier
19500101                    #observation date
0300                        #observation time
4                           
+51317                      #latitude(degrees x 1000)
+028783                     #longitude(degrees x 1000)
FM-12
+0171                       #elevation(meters)
99999
V020
320                         #wind direction(degrees)
1                           #quality code
N
0072
1
00450                       #sky ceiling height(meters)
1                           #quality code
C
N
010000                      #visibility distance(meters)
1                           #quality code
N
9
-0128                       #air temperature(degrees Celsius * 10)
1                           #quality code
-0139                       #dew point temperature(degrees Celsius * 10)
1                           #quality code
10268                       #atmospheric pressure(hectopascals * 10)
1                           quality code
```
**数据文件按照日期和气象站进行组织**。从1901年到2001年，每一年都有一个目录，每一个目录中包含各
个气象站该年气象数据的打包文件及其说明文件。例如，1999年对应文件夹下面就包含下面的记录：
```shell
$ ls raw/1990 | head
010010-99999-1990.gz
010014-99999-1990.gz
010015-99999-1990.gz
010016-99999-1990.gz
010017-99999-1990.gz
010030-99999-1990.gz
010040-99999-1990.gz
010080-99999-1990.gz
010100-99999-1990.gz
010150-99999-1990.gz
```
气象台有成千上万个，所以整个数据集由 **大量的小文件** 组成。**通常情况下，处理少量的大型文件更容
易、更有效**。因此，这些数据需要经过预处理，将每年的数据文件拼接成一个单独的文件。
