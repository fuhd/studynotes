集成健康医疗数据
===========================================================================
从原始数据到健康医疗相关的问题答案之间，有着许多处理步骤。这里我们讨论其中一个步骤：**将来自多个源的、
关于同一个人的数据集中起来**。

不幸的是，在美国缺乏通用的病人标识符，再加上噪声数据的影响，例如不同系统中个人姓名和统计资料的变异，
使得跨越多个源将一个人的数据精确地统一起来非常困难。分布在多个源中的信息可能看起来如下表所示：

| 源 | 个人ID | 名 | 姓 | 地址 | 性别 |
|:---|:------|:---|:---|:----|:----|
| 医生办公室 | 12345 | Abraham |Lincoln | 1600 Pennsylvania Ave. | M |
| 医院 | 98765 | Abe | Lincoln | Washington, DC | M |
| 医院 | 45678 | Mary Todd | Lincoln | 1600 Pennsylvania Ave. | F |
| 诊所 | 76543 | A. | Lincoln | Springfield, IL | M |

在健康医疗领域，上述数据统一问题通常是通过一个称为“**企业级患者主索引**”（`EMPI，Enterprise Master Patient index`）
的系统来解决的。**一个`EMPI`可以从多个系统中获取数据，并确定哪些记录确实是对应了同一个人**。有很多途径可以达
到这种目的，例如，明确声明各自关系的人类，或是能够识别共性的复杂算法。

在某些情况下，我们可以 **从外部系统载入`EMPI`信息**，而在另一些情况下，我们 **可以在`Hadoop`内对其进行计算**。
关键在于我们 **可以将这一信息提供给基于`Crunch`的管线使用**。其结果便是`PCollection<EMPIRecord>`，数据结构如下：
```java
@namespace("com.cerner.example")
protocol EMPIProtocol {
    record PersonRecordId {
        string sourceId;
        string personId;
    }
    /**
     * Represents an EMPI match.
     */
    record EMPIRecord {
        string empiId;
        array<PersonRecordId> personIds;
    }
}
```
给定这一结构中数据的`EMPI`信息，`PCollection<EMPIRecord>`将会包含类似于下表所示的数据：

| EMPI标识符 | 个人记录ID(<源ID，个人ID>) |
|:----------|:-------------------------|
| EMPI-1 | <offc-135, 12345> |
|        | <hspt-246, 98765> |
|        | <clnc-791, 76543> |
| EMPI-2 | <hspt-802, 45678> |

