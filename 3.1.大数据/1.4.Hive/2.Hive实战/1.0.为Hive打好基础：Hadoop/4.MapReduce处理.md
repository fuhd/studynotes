MapReduce处理
===================================================================================
**MapReduce要将大型作业划分成可并行执行的任务，对于Hadoop集群上的分布式处理来说，这仍然是最基本
的方式**。像Hive和Pig这样的应用程序，仍然可以在后台执行MapReduce（**尽管并不推荐**），而且理解
MapReduce的工作模式是很有帮助的，这样就可以更好地优化我们的查询并理解它们的行为。**随着YARN的出
现，MapReduce只是在Hadoop上访问数据的另一种手段而已**。
```
注意 

YARN代表Yet Another Resource Negotiator（另一种资源协调器）。YARN是由Hortonworks公司的Arun Murthy开发的，被称为“面向
Hadoop的操作系统”。它将资源管理从最初的MapReduce框架中分离出来，使MapReduce将重点放在分布式处理上，而不是资源和任务
管理上。现在，YARN下的集群资源管理已经得到推广，它使得其他具有不同访问模式（交互、实时以及批处理）的应用程序能够同时在同
一集群上运行。YARN在Hadoop2.x中引入。Hadoop2.x之前的版本被标记为传统Hadoop。YARN出现之前的MapReduce被称为MRv1，
YARN出现之后的MapReduce则被称为MRv2。
```
**Map阶段是MapReduce并行处理的第一部分**。回想一下Hadoop如何在磁盘上存储数据。它会将一个文件分
成多个块，每个块都包含总数据的一部分。因此，如果你有个1TB的文件并且其中含有一份名单，那么该文件将
被分割成大量的块，其中每个块都包含该名单的一个子集，这些子集存储在集群中的各个节点上。

请记住，Hadoop将并行处理这些任务。**在Map阶段，节点之间不需要通信。在处理大型数据集时这是非常重要
的，因为你不希望出现系统内部通信或节点之间的数据传输**。在处理中引入依赖项会导致诸如竞争条件和死锁
等问题。通过并行处理，Hadoop在所谓的“无共享”架构中充分利用了专用IO资源。在我们的场景中，Map任
务在留存数据的节点上运行。Map阶段从不将数据提取到中心位置进行处理。同样，这也是处理大型数据集的关
键，因为在网络上移动数TB甚至是数PB的数据是不可行的。我们希望在节点上就近处理数据，并且利用该节点可
用的全部内存、磁盘和CPU资源。

在Map阶段完成之后，我们还有一个名为 **混洗和排序（shuffle and sort）的中间阶段。该阶段从Map阶段获取
所有键/值对，并且将它们分配给一个约简器。每个约简器都接收与某个键相关联的所有数据。混洗和排序阶段是
数据在集群中物理移动且进程之间进行通信的唯一时间段**。
```
警告

当我们深入研究Hive的性能时，将会重点规避Reduce阶段。这一阶段可能成为瓶颈，因为它需要在网络上移动数据，节点间还需要通信。
同样，在所有映射完成之前，不能开始Reduce阶段。
```













