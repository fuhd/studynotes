UserManager
================================================================================
当您启动Azkaban时，您可能会注意到登录页面。Azkaban让您在使用之前进行身份验证。这可以防止查看或
执行您看不到或触摸的工作流程。

我们还使用经过身份验证的用户进行审核。每当项目文件发生变化，修改，安排等时，我们通常都想知道哪个
用户执行了该操作。

**用户界面**：

![用户界面](img/1.png)

## XmlUserManager
`XmlUserManager`是Azkaban中内置的默认UserManager。要显式设置配置`XmlUserManager`的参数，
可以在`azkaban.properties`文件中设置以下参数。

| 参数 | 默认
|:--- |:--- |
| `user.manager.class` | azkaban.user.XmlUserManager |
| `user.manager.xml.file` | azkaban-users.xml |

需要修改的另一个文件是`azkaban-users.xml`文件。XmlUserManager将在启动期间解析用户xml文件一
次以设置用户。

一切都必须包含在`<azkaban-users>`标签中。
```xml
<azkaban-users>
    ...
</azkaban-users>
```

### 1.用户
要添加用户，请添加`<user>`标记：
```xml
<azkaban-users>
    <user username="myusername" password="mypassword" roles="a" groups="mygroup"/>
    <user username="myusername2" password="mypassword2" roles="a, b" groups="ga, gb"/>
    ...
</azkaban-users>
```

| 属性 | 值 | 必须? |
|:---- |:---- |:---- |
| `username` | 登录用户名 | 是 |
| `password` | 登录密码 | 是 |
| `roles` | 逗号分隔的此用户具有的角色列表 | 否 |
| `groups` | 以逗号分隔的用户所属组的列表 | 否 |
| `proxy` | 逗号分隔的此用户可以为项目提供的代理用户列表 | 否 |

### 2.组
要添加用户，请添加`<group>`标记：
```xml
<azkaban-users>
    <user username="a" ... groups="groupa" />
    ...
    <group name="groupa" roles="myrole"/>
    ...
</azkaban-users>
```
在前面的示例中，用户`'a'`位于组`'groupa'`中。用户`'a'`也有`'myrole'`角色。普通用户无法向项
目添加组权限，除非他们是该组的成员。

以下是您可以分配的一些组属性。

| 属性 | 值 | 必须? |
|:---- |:---- |:---- |
| `name` | 组名 | 是 |
| `roles` | 逗号分隔列表角色的全局权限 | 否 |

### 3.角色
角色的不同之处在于它为Azkaban中的用户分配全局权限。您可以使用`<roles>`标记设置角色：
```xml
<azkaban-users>
    <user username="a" ... groups="groupa" roles="readall" />
    <user username="b" ... />
    ...
    <group name="groupa" roles="admin" />
    ...
    <role name="admin" permissions="ADMIN" />
    <role name="readall" permissions="READ" />
</azkaban-users>
```
在上面的示例中，用户`a`具有角色`readall`，其被定义为具有`READ`权限。这意味着用户`a`对所有项目
和执行都具有全局READ访问权限。

用户`a`也在`groupa`中，其角色为`ADMIN`。这当然是多余的，但用户`a`也被授予所有项目的ADMIN角色。

可能的角色权限如下：

| 属性 | 值 | 必须？|
|:---- |:---- |:---- |
| `name` | 组名 | 是 |
| `permissions` | 逗号分隔列表角色的全局权限 | 是 |

可能的角色权限如下：

| 权限 | 描述 |
|:---- |:---- |
| `ADMIN` | 授予Azkaban所有权限。 |
| `READ` | 为用户提供对每个项目及其日志的只读访问权限 |
| `WRITE` | 允许用户上传文件，更改作业属性或删除任何项目 |
| `EXECUTE` | 允许用户触发任何流的执行 |
| `SCHEDULE` | 用户可以为任何流添加或删除计划 |
| `CREATEPROJECTS` | 如果项目创建被锁定，则允许用户创建新项目 |

## 自定义用户管理器
尽管XmlUserManager很容易入门，但您可能希望与已建立的目录系统（如LDAP）集成。

实现自定义UserManager应该是相当直接的。UserManager是一个java接口。只需要几种方法来实现：
```java
public interface UserManager {
    public User getUser(String username, String password) throws UserManagerException;
    public boolean validateUser(String username);
    public boolean validateGroup(String group);
    public Role getRole(String roleName);
    public boolean validateProxyUser(String proxyUser, User realUser);
}
```
构造函数应该使用`azkaban.utils.Props`对象。`azkaban.properties`的内容可供UserManager进
行配置。

将新的自定义UserManager打包到jar中并将其放入`./extlib`目录或插入plugins目录（即
`./plugins/ldap/linkedin-ldap.jar`）。

将`azkaban.properties`配置更改为指向自定义UserManager。如果自定义用户管理器需要，请将其他参
数添加到`azkaban.properties`中。

| 参数 | 默认值 |
|:---- |:---- |
| `user.manager.class` | azkaban.user.CustomUserManager |
