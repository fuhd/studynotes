创建流程
================================================================================
本节介绍如何使用 **Azkaban Flow 2.0** 创建Azkaban流程。**Flow 1.0将来会被弃用**。

## 1.Flow 2.0基础知识

### 1.1.第1步
创建一个名为`flow20.project`的简单文件。添加`azkaban-flow-version`以表明这是Flow 2.0 
Azkaban项目：
```ini
azkaban-flow-version: 2.0
```

### 1.2.第2步
创建另一个名为`basic.flow`的文件。添加一个名为`nodes`的部分，其中包含您要运行的所有job。您需
要为所有job指定`name`和`type`。大多数job也需要`config`部分。我们稍后会详细讨论它。下面是一个
command job的简单示例。
```yaml
nodes:
  - name: jobA
    type: command
    config:
      command: echo "This is an echoed text."
```

### 1.3.第3步
**选择您已创建的两个文件，然后右键单击将它们压缩为一个名为的`zip`文件`Archive.zip`。您还可以
使用这两个文件创建一个新目录，然后cd进入新目录并压缩：**请不要直接压缩新目录**。
`zip -r Archive.zip .`

确保您已经在Azkaban上创建了一个项目。然后，您可以通过`Web UI`将`Archive.zip`上传到项目中。
**注：创建项目与上传到项目，参考后续的文档**。

现在您可以单击以测试您的第一个Flow 2.0 Azkaban项目！`Execute Flow`。

## 2.Job依赖
**Job可以相互依赖**。您可以使用`dependsOn`列出所有父作业。在下面的示例中，jobA和jobB成功运行
后，jobC将开始运行。
```yaml
nodes:
  - name: jobC
    type: noop
    # jobC depends on jobA and jobB
    dependsOn:
      - jobA
      - jobB

  - name: jobA
    type: command
    config:
      command: echo "This is an echoed text."

  - name: jobB
    type: command
    config:
      command: pwd
```
您可以压缩新`basic.flow`和`flow20.project`，然后再次上传到Azkaban。尝试执行流程并查看差异。

## 3.Job配置
Azkaban支持许多job类型。您只需要在`type`中指定它，其他与job相关的信息将以`key:value`的格式
转到`config`部分。以下是Pig job的示例：
```yaml
nodes:
  - name: pigJob
    type: pig
    config:
      pig.script: sql/pig/script.pig
```
您需要编写自己的pig脚本并将其放在项目zip中，然后在config部分中指定pig.script的路径。

## 4.Flow配置
您不仅可以配置单个job，还可以为整个flow配置flow参数。只需在`basic.flow`文件的开头添加一个
`config`部分。例如：
```yaml
---
config:
  user.to.proxy: foo
  failure.emails: noreply@foo.com

nodes:
  - name: jobA
    type: command
    config:
      command: echo "This is an echoed text."
```
执行flow时，`user.to.proxy`和`failure.emails`flow参数将应用于流内的所有作业。

## 5.嵌入式flow
Flow可以像job一样，作为subFlow嵌入Flow中。要创建嵌入式Flow，请将节点类型指定为`flow`。例如：
```yaml
nodes:
  - name: embedded_flow
    type: flow
    config:
      prop: value
    nodes:
      - name: jobB
        type: noop
        dependsOn:
          - jobA
      - name: jobA
        type: command
        config:
          command: pwd
```