CDH5.14.x完全卸载
================================================================================
### 1.记录用户数据路径
用户数据路径列出了需要删除的用户数据：
```shell
/var/lib/flume-ng
/var/lib/hadoop*
/var/lib/hue
/var/lib/navigator
/var/lib/oozie
/var/lib/solr
/var/lib/sqoop*
/var/lib/zookeeper
# 请修改 data_drive_path 为自己机器上的路径
data_drive_path/dfs
data_drive_path/mapred
data_drive_path/yarn
```
上面这些都是默认设置。

### 2.停止所有服务
在cloudera manager管理页面：
1. 在 **主页->状态** tab页面上，点击集群名字右边的 **下箭头**，打开菜单点击 **停止**。
2. 在 **主面->状态** tab页面上，点击cloudera management service条目右侧的 **下箭头**，
打开菜单点击 **停止**。

### 3.取消激活和删除Parcels
如果您使用 **parcels** 进行安装，请按以下步骤进行删除：
1. 点击cloudera management的 **管理页面导航栏** 上的 **包裹** 按钮。
2. 在打开的界面中，对于每个 **已分配，已激活** 的parcel，请选择 **操作>停用**。 此操作完成后，
parcel的按钮将变为 **激活**。
3. 对于每个 **显示激活** 的parcel，请选择 **操作>从主机中删除**。 此操作完成后，parcel按钮将更改为 **分配**。
这会从本地parcels存储库中删除parcel。

### 4.删除集群
在 **主页** 上，单击要删除的 **集群** 旁边的 **下拉列表**，然后选择 **删除**。

### 5.卸载Cloudera Manager服务
如果是用 **cloudera-manager-installer.bin** 文件进行安装的（我们就是），在安装cloudera-manager服务的
节点（**server01**）上执行下面的命令：
```shell
/usr/share/cmf/uninstall-cloudera-manager.sh
```

### 6.卸载Cloudera Manager Agent与管理软件
在所有有代理的主机上（**server01~06**）执行如下操作。

#### 6.1.停止Cloudera Manager Agent
```shell
service cloudera-scm-agent next_stop_hard
service cloudera-scm-agent stop
```

#### 6.2.卸载软件
```shell
yum remove 'cloudera-manager-*'
```

#### 6.3.运行清理命令
```shell
yum clean all
```

### 7.删除Cloudera Manager和用户数据

#### 7.1.杀死Cloudera Manager和受管进程
在所有代理主机（**server01~06**）上，终止正在运行的Cloudera Manager和受管进程：
```shell
# 注： 如果您正确停止了所有服务和Cloudera Manager Agent，则无需执行此步骤。
for u in cloudera-scm flume hadoop hdfs hbase hive httpfs hue impala llama mapred oozie solr spark sqoop sqoop2 yarn zookeeper; do kill $(ps -u $u -o pid=); done
```

##### 7.2.删除Cloudera Manager数据
如果要在 **RHEL** 上卸载，请在 **所有代理主机（server01~06）** 上运行以下命令以 **永久删除Cloudera Manager数据**。
如果您希望将来能够访问任何此类数据，则必须在删除之前对其进行备份。如果您使用 **嵌入式PostgreSQL数据库**，
数据存储在：**/var/lib/cloudera-scm-server-db**。
```shell
umount cm_processes
rm -Rf /usr/share/cmf /var/lib/cloudera* /var/cache/yum/cloudera* /var/log/cloudera* /var/run/cloudera*
```

#### 7.3.删除Cloudera Manager锁文件
在 **所有代理主机（server01~06）** 上，运行以下命令以删除Cloudera Manager锁定文件：
```shell
rm /tmp/.scm_prepare_node.lock
```

#### 7.4.删除用户数据
此步骤将 **永久删除所有用户数据**。要保留数据，请在开始卸载过程之前使用 **distcp命令** 将其复制到另一个群集。
在 **所有代理主机** 上，运行以下命令：
```shell
rm -Rf /var/lib/flume-ng /var/lib/hadoop* /var/lib/hue /var/lib/navigator /var/lib/oozie /var/lib/solr /var/lib/sqoop* /var/lib/zookeeper
```
在 **所有代理主机（server01~06）** 上的每个数据驱动器上运行以下命令（**调整每个主机上数据驱动器的路径**）：
```shell
# data_drive_path 换成自己的路径
rm -Rf data_drive_path/dfs data_drive_path/mapred data_drive_path/yarn
```

#### 7.5.停止并删除外部数据库
如果选择将Cloudera Manager或用户数据存储在外部数据库中，**请自行删除**。

### 8.卸载CDH组件
参见：[卸载CDH组件](https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_ig_cdh_comp_uninstall.html#topic_27_4)

这一步感觉没有必要！！
