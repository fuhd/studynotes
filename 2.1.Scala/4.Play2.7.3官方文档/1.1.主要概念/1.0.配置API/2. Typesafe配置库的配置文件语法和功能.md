Typesafe配置库的配置文件语法和功能
===================================================================================
Play使用的配置文件基于 [Typesafe配置库](https://github.com/lightbend/config)。

Play应用程序的配置文件必须在`conf/application.conf`中定义，它使用 **[HOCON格式](https://github.com/lightbend/config/blob/master/HOCON.md)**。

**除application.conf文件外，配置还来自其他两个地方**。
+ 默认设置是从类路径上找到的任何`reference.conf`文件中加载的。 大多数Play JAR都包含带有默认设置的
`reference.conf`文件。**application.conf中的设置将覆盖reference.conf文件中的设置**。
+ 也可以使用系统属性来设置配置。**系统属性将覆盖application.conf设置**。

使用Config的惯用方式是将所有配置键定义在`reference.conf`或`application.conf`中的某个位置。 如果key没
有合理的默认值，则通常将其设置为`null`表示“无值”。

## 1. 指定备用配置文件
在运行时，将从类路径加载默认的`application.conf`。**系统属性可用于强制使用其他配置源**：
+ `config.resource`指定一个包含扩展名的资源名称，即`application.conf`，而不仅仅是`application`。
+ `config.file`指定文件系统路径，再次应包含扩展名，而不是基本名称。

**这些系统属性指定了application.conf的替换项，而不是附加项**。如果仍要使用`application.conf`文件中
的某些值，则可以通过在该文件的顶部写入 **include "application"** 来将`application.conf`包含在其他
`.conf`文件中。将`application.conf`的设置包含在新的`.conf`文件中之后，您可以指定要 **覆盖** 的所有设
置。

## 2. 从控制器使用
由于 **依赖注入**，因此可以在控制器（或组件）中使用 **默认设置** 或 **自定义设置** 来使用配置。
```scala
import javax.inject._
import play.api.Configuration

class MyController @Inject()(config: Configuration) {
  // ...
}
```

## 3. 与Akka一起使用
Akka将使用与为您的Play应用程序定义的配置文件 **相同的配置文件**（也就是说，**他们共用配置文件**）。 
这意味着您可以在`application.conf`文件的Akka中配置任何内容。在Play中，Akka从`play.akka`设置中读取
其设置，而不是从`akka`设置中读取。

## 4. 与run命令一起使用
使用`run`命令运行应用程序时，需要了解一些有关配置的特殊信息。

### 4.1. 额外的devSettings
您可以在`build.sbt`中为`run`命令配置其他设置。**部署应用程序时将不会使用这些设置**。
```
PlayKeys.devSettings += "play.server.http.port" -> "8080"
```

### 4.2. application.conf中的HTTP服务器设置
在`run`模式下，Play的HTTP服务器部分在编译应用程序之前启动。 **这意味着HTTP服务器启动时无法访问
`application.conf`文件**。 如果要在使用`run`命令时覆盖HTTP服务器设置，则不能使用`application.conf`
文件。 相反，**您需要使用系统属性或上面显示的`devSettings`设置**。 服务器设置的一个示例是HTTP端口：
```shell
> run -Dhttp.port=1234
```
其他服务器设置可以在[这里](https://www.playframework.com/documentation/2.7.x/ProductionConfiguration#Server-configuration-options)看到。 如您在这些服务器设置中看到的，如果尚未通
过`PlayKeys.devSettings`定义端口或地址，则http(s)端口和地址将回退到配置键`PLAY_HTTP_PORT`，
`PLAY_HTTPS_PORT`和`PLAY_HTTP_ADDRESS`。**由于这些配置键是替换键**，因此您也可以通过 **环境
变量** 定义设置它（例如，在Linux中使用Bash时）：
```shell
export PLAY_HTTP_PORT=9001
export PLAY_HTTPS_PORT=9002
export PLAY_HTTP_ADDRESS=127.0.0.1
```
如果您需要针对 **开发模式（与run命令一起使用的模式）** 定制Akka配置，则还有一个 **特定的命名空间**。 
您需要在`PlayKeys.devSettings`中使用`play.akka.dev-mode`作为配置的 **前缀**，例如：
```scala
PlayKeys.devSettings += "play.akka.dev-mode.akka.cluster.log-info" -> "off"
```
如果使用的Akka ActorSystem运行开发模式与应用程序本身使用的ActorSystem之间存在某些冲突，**则此功能
特别有用**。

## 5.HOCON语法
HOCON与JSON有相似之处；

### 5.1. 保持与JSON一样，不变
+ 文件必须是有效的UTF-8；
+ 带引号的字符串与JSON字符串的格式相同；
+ 值具有可能的类型：字符串，数字，对象，数组，布尔值，空；
+ 允许的数字格式与JSON匹配；与JSON中一样，未表示某些可能的浮点值，例如NaN。

### 5.2. 注释
`//`或`#`与下一个换行符之间的任何内容均被视为注释并被忽略，除非`//`或`#`包含在带引号的字符串中。

### 5.3. 省略根括号
**JSON文档的根必须有一个数组或对象**。空文件和所有仅包非数组非对象值（例如字符串）的文件一样，都
是无效文档。

**在HOCON中，如果文件不是以方括号或大括号开头，则将其解析为好像用`{}`大括号括起来一样**。
