安装配置
================================================================================
### 1.安装Java
Elasticsearch需要Java7或者更高版本的支持。建议使用最新的Java8+。（安装略）

### 2.安装Elasticsearch
中国官网: https://www.elastic.co/cn/ ，目前最新版本 **6.2.4**。

Elasticsearch是Java开发的，所以JVM的环境变量 **JAVA_OPTS** 对Elasticsearch是非常重要的。
在JAVA_OPTS中对Elasticsearch最重要的参数是　**-Xmx** 最大可以使用内存的参数，一般情况下大内存
更能发挥Elasticsearch作用，**建议-Xmx设置为物理内存的一半，为了减少内存分配带来的性能损耗，最好一
开始就设置初始内存和最大内存都为物理内存的一半，即Xms和Xmx这两个参数**。

由于JAVA_OPTS大多数时候对整个机器环境起作用，**所以最好是保留默认的JAVA_OPTS，最好用ES_JAVA_OPTS
环境变量设置来作为JAVA_OPTS参数**。

### 3.配置
Elasticsearch配置文件在 **elasticsearch/config** 文件夹下。在这个文件夹中有两个文件，**一个是
Elasticsearch配置不同模块的配置文件elasticsearch.yml，另一个是Elasticsearch日志的配置文件logging.yml**。

**Elasticsearch提供了多种方式进行设置**，在系统内部，都使用 **命名空间** 来表示这些设置，根据这些命
名空间，系统可以很容易地扩展到其他格式。比如我们设置节点名称如下：
1. **yml格式** 为：node.name: node-1
2. **JSON格式** 为：只需要把elasticsearch.yml名修改成elasticsearch.json。配置的方式为：
```json
｛
    “node”: {"name": "node-1"}
 ｝
```
3. 通过Elasticsearch **命令的参数** 来设置配置信息。例如：
```shell
elasticssarch -Des.node.name=node-1
```
4. Elasticsearch还可以通过 **交互式方式** 进行设置，通过 **${prompt.text}** 或者
**${prompt.secret}** 来指定，**${prompt.secret}表示在终端中隐藏输入的值，${prompt.text}表**
示在终端中显式输入的值。例如：
```yaml
node.name: ${prompt.text}
```
在Elasticsearch命令执行时，将提示你输入的实际值，例如下面的提示：
```
Enter value for ［node.name]：
```
**注：当Elasticsearch作为服务或者在后台启动的时候，这两个参数不起作用**。

#### 3.1.elasticsearch.yml配置说明
**集群名称**：
```yaml
cluster.name: my-application
```
**确保在不同的环境中集群的名称不重复**，否则，节点可能会连接到错误的集群上。

**节点名称**：
```yaml
node.name: node-1
```
**默认情况下**，当节点启动时Elasticsearch将 **随机在一份3000个名字的列表中随机指定一个**。如果
机器上只运行一个集群Elasticsearch节点，可以用 **${HOSTNAME}** 设置节点的名称为主机名。

**节点描述**：
```yaml
node.rack: r1
```

**索引存储位置**：
```yaml
path.data: /path/to/data
```

**日志存储位置**：
```yaml
path.logs: /path/to/logs
```

**内存分配模式**：
```yaml
bootstrap.mlockall: true
```

**绑定的网卡IP**：
```yaml
network.host: 192.168.0.1
```

**http协议端口**：
```yaml
http.port: 9200
```

**开始发现新节点的IP地址**：
```yaml
discovery.zen.ping.unicast.hosts: ["host1", "host2"]
```
**最多发现主节点的个数**：
```yaml
discovery.zen.minimum_master_nodes: 3
```
**当重启集群节点后最少启动N个节点后开始做恢复**:
```yaml
gateway.recover_after_nodes: 3
```
**在一台机器上最多启动的节点数**：
```yaml
node.max_local_storage_nodes: 1
```
**当删除一个索引的时候，需要指定具体索引的名称**：
```yaml
action.destructive_reguires_name: true
```

#### 3.2.索引配置说明
在集群中创建的索引 **可以提供每个索引自己的设置**。例如，下面创建一个索引刷新间隔是5秒钟而不是默认的
刷新间隔（格式可以是YAML或JSON）：

请求：
```
PUT http://127.0.0.1:9200/kimchy
```
参数：
```yaml
index：refresh_interval: 5s
```
**这个索引参数可以设置在节点上**，例如，在 **elasticsearch.yml** 文件中可以设置：
```yaml
index.refresh_interval: 5s
```
这意味着除非索引明确定义，这个节点上创建的每个索引的刷新间隔为5秒。当然也 **可以在启动Elasticsearch的
时候用参数指定**：
```shell
elasticsearch -Des.index.refresh_interval=5s
```

#### 3.3.日志配置说明
Elasticsearch内部使用log4j记录系统日志，它试图通过使用YAML配置方式来简化log4j的配置，**配置文件
位置为elasticsearch/config/logging.yml**。JSON格式和键值对的格式也是支持的。可以加载多个配置
文件，在启动Elasticsearch后系统自动合并多个配置文件。支持不同的后缀格式，例如：（.yml、.yaml、
.json or .properties）。

由于日志比较重要，**正常情况下不要禁止日志的产生**，如果感觉日志过多，可以提高日志的级别。系统日志每
日会生成一个新的文件。











































ddd
