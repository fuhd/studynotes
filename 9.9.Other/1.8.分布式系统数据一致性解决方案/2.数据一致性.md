数据一致性
=============================================================
### 强一致性
当更新操作完成之后，任何多个后续进程或者线程的访问都会返回最新的更新过的值。这种是对用户最友好的，
就是用户上一次写什么，下一次就保证能读到什么。根据 **`CAP`** 理论，这种实现需要 **牺牲可用性**。

### 弱一致性
系统并不保证后续进程或者线程的访问都会返回最新更新过的值。**系统在数据写入成功之后，不承诺立即可以读到最新写入的值，
也不会具体的承诺多久之后可以读到**。

### 最终一致性
**最终一致性是弱一致性的特定形式**。系统保证在没有后续更新的前提下，系统最终返回上一次更新操作的值。
在没有故障发生的前提下，不一致窗口的时间主要受 **通信延迟，系统负载和复制副本的个数** 影响。

在实际工程实践中，最终一致性存在以下5类主要变种：
+ **因果一致性**：因果一致性是指如果进程`A`在更新完某个数据项后通知了进程`B`，那么进程`B`之后对该数据项的
访问都应该能够获取到进程`A`更新后的最新值，并且如果进程`B`要对该数据项进行更新操作的话，务必基于进程`A`更新后的最新值，
即不能发生丢失更新情况。与此同时，与进程`A`无因果关系的进程`C`的数据访问则没有这样的限制。
+ **读己之所写(因果一致性特例)**：读己之所写是指进程`A`更新一个数据项之后，它自己总是能够访问到更新过的最新值，
而不会看到旧值。也就是说，对于单个数据获取者而言，其读取到的数据一定不会比自己上次写入的值旧。因此，
**读己之所写也可以看作是一种特殊的因果一致性**。
+ **会话一致性**：会话一致性将对系统数据的访问过程框定在了一个会话当中，系统能保证在同一个有效的会话中实现“读己之所写”的一致性，
也就是说，执行更新操作之后，客户端能够在同一个会话中始终读取到该数据项的最新值。
+ **单调读一致性**：单调读一致性是指如果一个进程从系统中读取出一个数据项的某个值后，那么系统对于该进程后续的
任何数据访问都不应该返回更旧的值。
+ **单调写一致性**：单调写一致性是指一个系统需要能够保证来自同一个进程的写操作被顺序地执行。

### 关注点
在工程实践上，为了保障系统的可用性，互联网系统大多 **将强一致性需求转换成最终一致性的需求**，
并通过系统 **执行幂等性** 的保证，保证数据的最终一致性。