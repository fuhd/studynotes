Http执行上下文
===========================================================
最初，`Http`被设计成一种无状态的、面向请求-响应的协议。然而，**在实际使用中，我们希望能够在一些逻辑相关的请求-响应中，
保持状态信息。为了使应用程序可以保持`Http`的持续状态，`HttpClient`允许`http`连接在特定的`Http`上下文中执行。
如果在持续的`http`请求中使用了同样的上下文，那么这些请求就可以被分配到一个逻辑会话中**。
`HTTP`上下文就和一个 **`java.util.Map<String, Object>`** 功能类似。它实际上就是一个任意命名的值的集合。
**应用程序可以在`Http`请求执行前填充上下文的值，也可以在请求执行完毕后检查上下文**。

**HttpContext** 可以包含任意类型的对象，因此 **如果在多线程中共享上下文会不安全。推荐每个线程都只包含自己的http上下文**。

在`Http`请求执行的过程中，`HttpClient`会自动添加下面的属性到 **Http上下文** 中：
+ `HttpConnection`的实例，表示客户端与服务器之间的连接
+ `HttpHost`的实例，表示要连接的目标服务器
+ `HttpRoute`的实例，表示全部的连接路由
+ `HttpRequest`的实例，表示`Http`请求。在执行上下文中，最终的`HttpRequest`对象会代表`http`消息的状态。
`Http/1.0`和`Http/1.1`都默认使用 **相对的uri**。但是 **如果使用了非隧道模式的代理服务器，就会使用绝对路径的uri**。
+ `HttpResponse`的实例，表示`Http`响应
+ `java.lang.Boolean`对象，表示请求是否被成功的发送给目标服务器
+ `RequestConfig`对象，表示`http request`的配置信息
+ `java.util.List<Uri>`对象，表示`Http`响应中的 **所有重定向地址**

我们可以使用 **`HttpClientContext`** 这个适配器来简化和上下文交互的过程。示例：
```java
HttpContext context = <...>
HttpClientContext clientContext = HttpClientContext.adapt(context);  
HttpHost target = clientContext.getTargetHost();  
HttpRequest request = clientContext.getRequest();  
HttpResponse response = clientContext.getResponse();  
RequestConfig config = clientContext.getRequestConfig();
```
**同一个逻辑会话中的多个`Http`请求，应该使用相同的`Http`上下文来执行，这样就可以自动地在`http`
请求中传递会话上下文和状态信息**。

在下面的例子中，我们在开头设置的参数，会被保存在上下文中，并且会应用到后续的`http`请求中。示例：
```java
CloseableHttpClient httpclient = HttpClients.createDefault();  
RequestConfig requestConfig = RequestConfig
        .custom()  
        .setSocketTimeout(1000)  
        .setConnectTimeout(1000)  
        .build();  
HttpGet httpget1 = new HttpGet("http://localhost/1");  
httpget1.setConfig(requestConfig);  
HttpContext context = <...>;
CloseableHttpResponse response1 = httpclient.execute(httpget1, context);
try{
    HttpEntity entity1 = response1.getEntity();
}finally{
    response1.close();
}  
HttpGet httpget2 = new HttpGet("http://localhost/2");  
CloseableHttpResponse response2 = httpclient.execute(httpget2, context);  
try{
    HttpEntity entity2 = response2.getEntity();
}finally{
    response2.close();
}
```
