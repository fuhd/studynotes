内嵌servlet容器支持
==========================
Spring Boot支持内嵌的`Tomcat`，`Jetty`和`Undertow`服务器。多数开发者只需要使用合适的'Starter POM'
来获取一个完全配置好的实例即可。默认情况下，内嵌的服务器会在 **8080端口** 监听HTTP请求。

### Servlets和Filters
当使用内嵌的servlet容器时，你可以直接将`servlet`和`filter`注册为Spring的Beans。在配置期间，
如果你想引用来自`application.properties`的值，这是非常方便的。默认情况下，如果上下文只包含单一的Servlet，
那它将被映射到根路径（`/`）。在多Servlet Beans的情况下，Bean的名称将被用作路径的前缀。过滤器会被映射到`/*`。
如果基于约定的映射不够灵活，你可以使用`ServletRegistrationBean`和`FilterRegistrationBean`类实现完全的控制。 如果你的Bean实现了`ServletContextInitializer`接口，也可以直接注册它们。示例：
```java
//定义Servlet
@Bean
public ServletRegistrationBean dispatcherServlet() {
  ServletRegistrationBean dispatcherServlet = new ServletRegistrationBean(new DispatcherServlet());
  dispatcherServlet.setName("dispatcherServlet");
  dispatcherServlet.addUrlMappings("/*");
  return dispatcherServlet;
}
//定义过滤器Filter
@Bean
public FilterRegistrationBean characterEncodingFilter() {
  FilterRegistrationBean characterEncodingFilter = new FilterRegistrationBean(
    new CharacterEncodingFilter(), dispatcherServlet());
  characterEncodingFilter.addUrlPatterns("/*");
  return characterEncodingFilter;
}
```
### 自定义内嵌servlet容器
常见的Servlet容器设置可以通过Spring Environment属性进行配置。通常，会把这些属性定义到`application.properties`文件中。 常见的服务器设置包括（当然不只下面这些）：

1. `server.port` - 进来的HTTP请求的监听端口号
2. `server.address` - 绑定的接口地址
3. `server.sessionTimeout` - session超时时间

#### 编程方式的自定义
```java
import org.springframework.boot.context.embedded.*;
import org.springframework.stereotype.Component;

@Component
public class CustomizationBean implements EmbeddedServletContainerCustomizer {
  @Override
  public void customize(ConfigurableEmbeddedServletContainer container) {
    container.setPort(9000);  //可以把`application.properties`中的值映射到Java对象上后向这里传
    //.................
  }
}
```
#### 直接自定义ConfigurableEmbeddedServletContainer
如果上面的自定义手法过于受限，你可以自己注册`TomcatEmbeddedServletContainerFactory`，
`JettyEmbeddedServletContainerFactory`或`UndertowEmbeddedServletContainerFactory`。
```java
@Bean
public EmbeddedServletContainerFactory servletContainer() {
  TomcatEmbeddedServletContainerFactory factory = new TomcatEmbeddedServletContainerFactory();
  factory.setPort(9000);
  factory.setSessionTimeout(10,TimeUnit.MINUTES);
  factory.addErrorPages(new ErrorPage(HttpStatus.NOT_FOUND,"/notfound.html"));
  return factory;
}
```
**注**：很多可选的配置都提供了setter方法， 也提供了一些受保护的钩子方法以满足你的某些特殊需求。

### JSP的限制
在 **内嵌的servlet容器中** 运行一个Spring Boot应用时，容器对 **JSP** 的支持有一些限制。

1. `tomcat`中，打 **`war`** 包时可使用JSP，打包成可执行jar时，不支持JSP。
2. `Jetty`目前不支持JSP。
3. `Undertow`不支持JSP。
