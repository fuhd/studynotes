Java安全之安全管理器、访问控制器和类装载器
================================================================================
## 1.安全管理器：SecurityManager
**安全管理器** 在Java语言中的作用就是检查操作是否有权限执行，**是Java沙箱的基础组件**。我们一
般所说的 **打开沙箱**，也是加 **-Djava.security.manager** 选项。

其实 **日常的很多API都涉及到安全管理器**，它的工作原理一般是：
1. **请求Java API**。
2. **Java API使用安全管理器判断许可权限**。
3. **通过则顺序执行，否则抛出一个Exception**。

我们看下SecurityManager的主要方法列表：
```
checkAccept(String, int)
checkAccess(Thread)
checkAccess(ThreadGroup)
checkAwtEventQueueAccess()
checkConnect(String, int)
checkConnect(String, int, Object)
checkCreateClassLoader()
checkDelete(String)
checkExec(String)
checkExit(int)
checkLink(String)
checkListen(int)
checkMemberAccess(Class<?>, int)
checkMulticast(InetAddress)
checkMulticast(InetAddress, byte)
checkPackageAccess(String)
checkPackageDefinition(String)
checkPermission(Permission)
checkPermission(Permission, Object)
checkPrintJobAccess()
checkPropertiesAccess()
checkPropertyAccess(String)
checkRead(FileDescriptor)
checkRead(String)
checkRead(String, Object)
checkSecurityAccess(String)
checkSetFactory()
checkSystemClipboardAccess()
checkTopLevelWindow(Object)
checkWrite(FileDescriptor)
checkWrite(String)
```
都是check方法，分别囊括了 **文件的读写删除和执行、网络的连接和监听、线程的访问、以及其他包括打印
机剪贴板等系统功能。而这些check代码也基本横叉到了所有的核心Java API上**。

**安全管理器可以自定义**，作为核心API调用的部分，我们可以自己为自己的业务定制安全管理逻辑。举个
例子如下：
```java
package com.fuhd;

public class SecurityManagerTest {
    static class MySM extends SecurityManager {
        @Override
        public void checkExit(int status) {
            throw new SecurityException("no exit");
        }
    }

    public static void main(String[] args) {
        MySM sm = new MySM();
        System.out.println(System.getSecurityManager());
        System.setSecurityManager(sm);//注释掉测一下
        System.exit(0);
    }
}
```



































dd
