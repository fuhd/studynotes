自定义加载器
================================================================================
## 1.JDK中的ClassLoader
在实现自己的ClassLoader之前，我们先看一下JDK中的ClassLoader是怎么实现的：
```java
protected synchronized Class<?> loadClass(String name, boolean resolve)
    throws ClassNotFoundException {
  // First, check if the class has already been loaded
  Class c = findLoadedClass(name);
  if (c == null) {
    try {
      if (parent != null) {
        c = parent.loadClass(name, false);
      } else {
        c = findBootstrapClass0(name);
      }
    } catch (ClassNotFoundException e) {
      // If still not found, then invoke findClass in order
      // to find the class.
      c = findClass(name);
    }
  }
  if (resolve) {
    resolveClass(c);
  }
  return c;
}
```
方法原理很简单，一步一步解释一下：
1. 第4行，首先查找`.class`是否被加载过。
2. 第5行~第11行，如果`.class`文件没有被加载过，那么会去找加载器的父加载器。如果父加载器不是null
（不是Bootstrap ClassLoader），那么就执行父加载器的loadClass方法，把类加载请求一直向上抛，
直到父加载器为null（是Bootstrap ClassLoader）为止。
3. 第12行~第16行，父加载器开始尝试加载`.class`文件，加载成功就返回一个`java.lang.Class`，加
载不成功就抛出一个ClassNotFoundException，给子加载器去加载。
4. 第18行~第20行，如果要解析这个`.class`文件的话，就解析一下，**主要就是将符号引用替换为直接引
用的过程**。

我们看一下`findClass`这个方法：
```java
protected Class<?> findClass(String name) throws ClassNotFoundException {
  throw new ClassNotFoundException(name);
}
```
是的，没有具体实现，只抛了一个异常，而且是`protected`的，这充分证明了：**这个方法就是给开发者重
写用的**。

## 2.自定义类加载器
从上面对于`java.lang.ClassLoader`的`loadClass(String name, boolean resolve)`方法的解
析来看，可以得出以下2个结论：
1. **如果不想打破双亲委派模型，那么只需要重写findClass方法即可**。
2. **如果想打破双亲委派模型，那么就重写整个loadClass方法**。

**当然，我们自定义的ClassLoader不想打破双亲委派模型，所以自定义的ClassLoader继承自
`java.lang.ClassLoader`并且只重写`findClass`方法**。

### 2.1.第一步
自定义一个实体类`Person.java`，我把它编译后的`Person.class`放在`~/fuhd/work`目录下：
```java
package com.fuhd;

public class Person {

    private String name;

    public Person() {
    }

    public Person(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return "I am a person, my name is " + name;
    }
}
```
































dd
